<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DROP2</title>
  <style>
    #x {
      width: 100vw;
      height: 100vh;
      background-color: white;
      font-size: 30px;
      z-index: 10;
    }

    @media (orientation: portrait) {
      #x {
        display: none;
      }
    }

    @media(orientation: landscape) {
      body>:not(#x) {
        display: none;
      }
    }

    body {
      margin: 0;
      background-color: beige;
      width: 100vw;
      height: 100vh;
      overflow: hidden;
    }

    #area {
      height: calc(100vh - 100vw);
    }

    #score {
      display: inline-block;
      width: 40vw;
    }

    #destroy {
      display: inline-block;
      width: 50vw;
      margin-top: 7vw;
      float: right;
    }

    #des>div{
      height: 10vw;
    }

    .drop[data-touch="o"]::before ,.drop[data-touch="o"]::after{
      display: inline-block;
      border-radius: 50%;
      content: '';
      position: absolute;
    }

    .drop[data-touch="o"]::before{
      width: 4vw;
      height: 4vw;
      margin: 3vw;
      background-color: white;
    }

    .drop[data-touch="o"]::after{
      width: 3vw;
      height: 3vw;
      margin: 3.5vw;
      background-color: black;
    }

    #display {
      width: 100vw;
      height: 100vw;
      background-color: white;
    }

    #display>div {
      height: 10vw;
    }

    .drop {
      display: inline-block;
      width: 10vw;
      height: 10vw;
      border-radius: 50%;
    }

    .drop[data-color="1"] {
      background-color: coral;
    }

    .drop[data-color="2"] {
      background-color: deepskyblue;
    }

    .drop[data-color="3"] {
      background-color: yellowgreen
    }

    .drop[data-color="4"] {
      background-color: silver;
    }

    .drop[data-color="5"] {
      background-color: transparent;
    }

    .drop[data-color="6"] {
      background-color: black;
    }

  </style>
</head>

<body>
  <div id="x">縦のスマホ</div>
  <div id="area">
    <button id="start">SATRT</button>
      <div id="score" style="display: none;">123</div><div id="destroy" style="display: none;"><div id="des"></div></div></div>
  </div>
  <div id="display"></div>


  <script>
    // document.getElementById('display').innerText=innerHeight/innerWidth
    const display = document.getElementById('display');

    document.getElementById('start').onclick = () => {
      document.getElementById('start').remove();

      //初期盤面
      let data = [];
      for (let i = 0; i < 10; i++) {
        let div = document.createElement('div');

        let d = [];
        for (let j = 0; j < 10; j++) {
          let c;
          do {
            c = Math.floor(Math.random() * 4) + 1;
          } while (c == d[j - 1] && c == d[j - 2] || i > 1 && c == data[i - 1][j] && c == data[i - 1][j])

          let div2 = document.createElement('div');
          div2.className = "drop";
          div2.id = `${i}${j}`;
          div2.dataset.color = c;
          div.appendChild(div2);
          d.push(c);
        }
        display.appendChild(div);
        data.push(d);
      }
      console.log(data)

      document.getElementById('score').style = "";
      document.getElementById('destroy').style = "";

      //消す形
      for(let i=0;i<2;i++){
        let div = document.createElement('div');
        for (let j = 0; j < 3; j++) {
          let div2 = document.createElement('div');
          div2.className = "drop";
          div2.id=`d${i}${j}`;
          //div2.dataset.color=5;
          div.appendChild(div2);
        }
        document.getElementById('des').appendChild(div);
      }

      //消す形決める
      let shape = [[[1,1,1],[0,0,0]] , [[1,1,0],[1,0,0]] , [[1,0,0],[1,1,0]] , [[1,1,0],[0,1,0]] , [[0,1,0],[1,1,0]]];
      const set_shape=()=>{
        let n = Math.floor(Math.random()*shape.length);
        let s = shape[n];
        shape.splice(n,1);
        console.log(s);
        for(let i=0;i<2;i++){
        for (let j = 0; j < 3; j++) {
          document.getElementById(`d${i}${j}`).dataset.color=5+s[i][j];
        }
      }
      if(s[0][0]){
        document.getElementById('d00').dataset.touch="o";
      }else{
        document.getElementById('d01').dataset.touch="o";
      }
      }

      set_shape();



      















    }

    document.getElementById('start').onclick()

  </script>
</body>

</html>
